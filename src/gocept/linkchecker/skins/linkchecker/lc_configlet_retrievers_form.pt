<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      metal:use-macro="here/prefs_main_template/macros/master"
      i18n:domain="linkchecker">

<metal:block fill-slot="top_slot">
   <tal:block define="dummy python:request.set('disable_border',1)" />
   <style type="text/css" tal:content="string: @import url($portal_url/lc_colors.css);;"></style>
</metal:block>

<body>

<div metal:fill-slot="prefs_configlet_main"
     tal:define="errors python:request.get('errors', {});
                 lc nocall:here/portal_linkchecker;
                 database lc/database;
                 conn database/checkConnection;
                 notify python:test(conn.ok, database.getClientNotifications(), None);
                 ">
  <div id="content" class="documentEditable"
       tal:condition="python:checkPermission('Manage users', here)">

    <h5 class="hiddenStructure">Views</h5>
        
    <ul class="contentViews">
      <li>
        <a href="lc_configlet"
           i18n:translate="label_configuration">Configuration</a>
      </li>
      <li class="selected">
        <a href=""
           tal:attributes="href template_id"
           i18n:translate="label_retrievers">Retrievers</a>
      </li>
    </ul>

    <div class="contentActions">
      &nbsp;
    </div>

    <div class="documentContent" id="region-content">
      <a name="documentContent"></a>
    <h1 i18n:translate="heading_mail_setup">Link Checker Setup</h1>

    <p i18n:translate="description_mail_setup">
        Link Checker setup for this portal
    </p>

        <fieldset>
                <legend i18n:translate="legend_assign">Retriever assignments</legend>
            <form action="lc_configlet_retrievers" method="post" name="retrievers">

              <table>
                <thead>
                  <tr style="text-align: left">
                    <th>Content type</th>
                    <th>Title</th>
                    <th>Retriever to check with</th>
                  </tr>
                </thead>
                <tbody>
                  <tr tal:repeat="type here/lc_configlet_types">
                    <td tal:content="string:${type/getId}" />
                    <td tal:content="string:${type/Title}" />
                    <td><select tal:attributes="name type/getId">
                        <option value="">none</option>
                        <option tal:repeat="retriever lc/retrieving/getAllRetrieverNames" 
                                tal:content="retriever"
                                tal:attributes="selected python:test(lc.retrieving.isRetrieverForType(retriever, type.getId()), 1,0);
                                                value retriever" />
                    </select></td>
                  </tr>
                </tbody>
              </table>

                <div class="formControls">
                    <input class="context"
                        tabindex=""
                        type="submit"
                        name="submit"
                        value="Save"
                        i18n:attributes="value"
                        tal:attributes="tabindex tabindex/next"/>
                </div>
            </form>
        </fieldset>
    </div>
  </div>
</div>

</body>
</html>
